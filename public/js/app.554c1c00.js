(function(){var t={1160:function(t,e,a){"use strict";var r=a(144),o=a(7283),i=a(5239),s=a(1096),n=a(3551),l=function(){var t=this,e=t._self._c;return e(s.Z,[t.displayAppBar?e("AppBar"):t._e(),e(n.Z,[e("router-view")],1),e("div",{staticClass:"version"},[e("span",[t._v("version")]),t._v(" "+t._s(t.version)+" ")])],1)},c=[],u=a(629),p=a(3250),d=function(){var t=this,e=t._self._c;return e("div",[e(p.Z,{attrs:{color:"#303030",flat:""}},[e("router-link",{staticClass:"logo-link",attrs:{to:"/"}},[e("img",{staticClass:"logo",attrs:{src:a(9432)}})])],1)],1)},h=[],m={name:"AppBar"},g=m,f=a(1001),y=(0,f.Z)(g,d,h,!1,null,"4be6b7a9",null),v=y.exports;const{version:b}=a(9876),{mapActions:w}=(0,u._p)("analytics"),k=6e4;let _;var Z={name:"App",data(){return{version:b}},methods:{...w(["patakaPing"])},created(){_||(this.patakaPing(),_=setInterval(this.patakaPing,10*k))},computed:{displayAppBar(){return"login"!==this.$route.name}},watch:{"$route.name":{handler(t,e){void 0!==e&&document.body.classList.remove("page--"+e.toLowerCase()),document.body.classList.add("page--"+t.toLowerCase())},immediate:!0}},components:{AppBar:v}},x=Z,C=(0,f.Z)(x,l,c,!1,null,null,null),P=C.exports,I=a(8345),S=a(1828),A=a(4437),L=a(6035),E=a(5057),B=a(1302),D=a(5294),T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e(L.Z,{staticClass:"px-12",attrs:{fluid:""}},[e(D.Z,{attrs:{justify:"center"}},[e(A.Z,{staticClass:"pt-0",attrs:{cols:"4"}},[e("Avatar",{staticClass:"pb-4",attrs:{size:"180px",type:"pataka",alt:t.profile.preferredName,image:t.profile.avatarImage}}),e("h1",{staticClass:"text-uppercase text-center"},[t._v(t._s(t.profile.preferredName))]),e("p",{staticClass:"grey--text text-center caption overflow-wrap"},[t._v(t._s(t.profile.feedId))]),e(A.Z,{staticClass:"mx-auto mt-8",attrs:{cols:"7"}},[e(D.Z,{staticClass:"py-2",attrs:{justify:"start",align:"center"}},[e("div",{staticClass:"dot mr-4 internet-dot",class:t.network.internetLatency?-1===t.network.internetLatency?"red":"green":"grey"}),e("p",{staticClass:"caption text-uppercase text-center ma-0"},[t._v(" "+t._s(t.network.internetLatency?-1===t.network.internetLatency?"Offline":"Online":"Checking")+" ")]),e("span",{staticClass:"network-latency"},[t._v(t._s(t.latency))])]),e(D.Z,{staticClass:"py-2 network-local",attrs:{justify:"start",align:"center"}},[e("div",{staticClass:"dot mr-4",class:t.network.ipv4?"green":"grey"}),e("p",{staticClass:"caption text-uppercase ma-0"},[t._v(" "+t._s(t.network.ipv4?" Local Network":"Checking")+" ")])]),e(D.Z,{staticClass:"py-2",attrs:{justify:"start",align:"center"}},[e("div",{staticClass:"dot mr-4",class:t.network.portForwarding?"green":null===t.network.internetLatency?"grey":"orange"}),e("p",{staticClass:"caption text-uppercase text-center ma-0"},[t._v(" "+t._s(t.network.portForwarding?"Port-Forwarding":null===t.network.portForwarding?"Checking":"Port-Forwarding Off")+" ")])]),e(D.Z,{staticClass:"mt-8",attrs:{justify:"center"}},[e("h2",{staticStyle:{"text-align":"center"}},[t._v("Disk Usage")]),t._l(t.diskUsage,(function(a){return e(B.Z,{key:a.fs,staticClass:"mt-4",attrs:{value:a.use,height:"25",color:"blue-grey"}},[e("strong",{staticClass:"pr-2"},[t._v(t._s(Math.ceil(a.use))+"%")]),e("span",{staticClass:"caption"},[t._v(t._s(a.fs))])])}))],2),t.cloudHost?e(D.Z,{attrs:{align:"center"}},[e(S.Z,{staticClass:"mt-6",attrs:{width:"100%",color:"red",outlined:""},on:{click:t.logout}},[t._v(" logout ")])],1):t._e()],1)],1),e(A.Z,{attrs:{cols:"8"}},[e(D.Z,[e(A.Z,{attrs:{cols:"12"}},[e(S.Z,{attrs:{color:"#53cb62",outlined:"",disabled:null===t.network.portForwarding},on:{click:function(e){return t.toggleDialog()}}},[t._v(" "+t._s(t.network.ipv4?"Generate join code":"Loading network data")+" ")])],1),t.generateError?e(A.Z,[e("p",{staticClass:"red--text caption mb-0"},[t._v(t._s(t.generateError))])]):t.generatedInvite?e(A.Z,{staticClass:"generated-code pl-6",attrs:{cols:"12"}},[e(D.Z,[e("p",{staticClass:"overline pt-2"},[t._v("Pātaka code:")])]),e(D.Z,[e("p",{staticClass:"pa-2",attrs:{id:"invite-code"}},[t._v(t._s(t.generatedInvite))])]),t.cloudHost?t._e():e(D.Z,[e(S.Z,{staticClass:"text-uppercase",attrs:{color:"grey",outlined:"",justify:"end"},on:{click:t.copyCode}},["Copy"===t.copyText?e(E.Z,{attrs:{small:"",left:""}},[t._v("mdi-content-copy")]):e(E.Z,{attrs:{small:"",left:""}},[t._v("mdi-check")]),t._v(" "+t._s(t.copyText)+" ")],1)],1)],1):t._e()],1),e(D.Z,{staticClass:"stat-column"},[e(A.Z,{attrs:{cols:"6"}},[e("Meter",{attrs:{title:"CPU",values:t.cpuLoad}})],1),e(A.Z,{attrs:{cols:"6"}},[e("Meter",{attrs:{title:"RAM",values:t.memoryLoad}})],1)],1),e(D.Z,{staticClass:"pt-6"},[e(A.Z,{staticClass:"stat-column",attrs:{cols:"6"}},[e("h2",{staticClass:"h2 text-uppercase pb-8"},[t._v("People")]),t.connectedPeople&&0!==t.connectedPeople.length?e(D.Z,{staticClass:"pb-2"},[e("div",[e("AvatarGroup",{attrs:{profiles:t.connectedPeople,size:"60px",showLabel:""}})],1)]):e("p",{staticClass:"caption"},[t._v("There is no one connected to your network")])],1),e(A.Z,{staticClass:"stat-column pl-6",attrs:{cols:"6"}},[e("h2",{staticClass:"h2 text-uppercase pb-8"},[t._v("Tribes")]),0===t.tribes.length?e("p",{staticClass:"caption"},[t._v("There are no tribes on your network")]):t._e(),e(D.Z,{staticClass:"pb-2"},[t.tribes&&t.tribes.length>0?e("div",[e("AvatarGroup",{attrs:{profiles:t.tribes,size:"60px",showLabel:""}})],1):t._e()])],1)],1)],1)],1)],1),t.dialog?e("GenerateInviteDialog",{attrs:{show:t.dialog,publicIpv4:t.network.publicIpv4,portForwarding:t.network.portForwarding,checkPortForwarding:t.checkPortForwarding,checkingPort:t.checkingPort,title:"Generate Invite Code",errorMsg:t.errorMsg,cloudHost:t.cloudHost},on:{close:t.toggleDialog,generate:function(e){return t.generateInviteCode(e)}}}):t._e()],1)},$=[],F=(a(7658),a(8819)),N=a(3296),O=a(2469),j=a(8236),q=function(){var t=this,e=t._self._c;return e("div",[e(A.Z,[e(D.Z,{attrs:{justify:"center"}},[e(N.Z,{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return[e(F.Z,{staticClass:"avatar-container",class:{isEditing:t.isEditing},attrs:{size:t.size,tile:t.tile,dark:t.dark}},[t.image&&t.image.uri?e(O.Z,{attrs:{src:t.hackURL(t.image.uri),alt:t.alt}}):e(O.Z,{staticClass:"no-pic",style:t.customStyle,attrs:{src:t.getImage}}),e(j.Z,{attrs:{absolute:"",opacity:"0.5",value:a&&t.showLabel}},[e("p",{staticClass:"text-center pt-2",staticStyle:{"font-size":"12px"}},[t._v(t._s(t.alt))])])],1)]}}])})],1)],1)],1)},M=[],z=a.p+"img/tane.b97713f0.svg",U=a.p+"img/wahine.6307c174.svg",H=a.p+"img/diverse.b5a2eb18.svg",R=a.p+"img/whakapapa.27a898a4.svg",V={defaultImage:G};function G(t,e){switch(t){case"person":switch(e){case"male":return z;case"female":return U;case"other":case"unknown":default:return H}case"pataka":case"whakapapa":default:return R}}var W={name:"Avatar",props:{showOnHover:Boolean,image:Object,alt:String,gender:String,type:{type:String,default:"person"},size:{type:String,default:"25vh"},showLabel:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},offline:{type:Boolean,default:!1},dark:Boolean,tile:Boolean},data:function(){return{hovered:!1}},computed:{getImage(){return V.defaultImage(this.type,this.gender||null)},customStyle(){return{opacity:this.offline?.5:1}}},components:{},methods:{hackURL(t){const e=new URL(t);return e.hostname=window.location.hostname,e.href},updateAvatar(t){this.$emit("updateAvatar",t)}}},X=W,K=(0,f.Z)(X,q,M,!1,null,"4a4637f6",null),J=K.exports,Y=function(){var t=this,e=t._self._c;return e(A.Z,{staticClass:"pt-0 pb-0"},[t.groupTitle?e(D.Z,[e(A.Z,{staticClass:"pt-1 pb-0"},[e("small",{staticClass:"label overline"},[t._v(" "+t._s(t.groupTitle)+" ")])])],1):t._e(),e(D.Z,{class:t.customClass},[t._l(t.profiles,(function(a,r){return e("div",{key:`${t.groupTitle}-${r}`,class:t.spacing,attrs:{width:"100%"}},[e("div",{staticClass:"pt-2",attrs:{justify:"center"}},[e("Avatar",{attrs:{size:t.size,isEditing:!1,type:a.type,image:a.avatarImage,alt:a.preferredName,gender:a.gender,showLabel:t.showLabels,clickable:t.clickable,deletable:t.deletable,dark:t.dark,row:t.row,tile:t.tile},on:{click:function(e){return t.profileClick(a)},delete:function(e){return t.$emit("delete",r)}}})],1)])})),t._t("action")],2)],1)},Q=[],tt={name:"AvatarGroup",components:{Avatar:J},props:{profiles:{type:Array,default:null},groupTitle:{type:String,default:null},showLabels:{type:Boolean,default:!0},size:{type:String,default:"80px"},customClass:{type:String,default:"d-flex justify-start align-center pa-2 pl-4"},spacing:{type:String,default:"pr-5"},deletable:Boolean,tile:Boolean,clickable:{type:Boolean,default:!0},dark:Boolean,row:Boolean},computed:{columns(){return this.profiles.length}},methods:{profileClick(t){this.$emit("profile-click",t)}}},et=tt,at=(0,f.Z)(et,Y,Q,!1,null,"698b1b22",null),rt=at.exports,ot=a(3927),it=a(5251),st=function(){var t=this,e=t._self._c;return e("Dialog",{attrs:{show:t.show,title:t.title,width:"720px",goBack:t.close,enableMenu:""},on:{close:t.close},scopedSlots:t._u([{key:"content",fn:function(){return[e(A.Z,{staticStyle:{color:"black"}},[e(D.Z,[e(A.Z,{attrs:{cols:"6"}},[e(it.Z,{attrs:{"error-messages":t.errorMsg,label:"This machines public IP",outlined:""},model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}})],1),e(A.Z,{staticClass:"mt-4"},[e(D.Z,{staticClass:"py-2",attrs:{justify:"start",align:"center"}},[e("div",{staticClass:"dot mr-4",class:t.portForwarding?"green":"orange"}),e("p",{staticClass:"caption text-uppercase text-center ma-0"},[t._v(" "+t._s(t.portForwarding?"Port-Forwarding":null===t.portForwarding?"Checking":"Port-Forwarding Off")+" ")])])],1)],1),t.portForwarding?t._e():e("div",[e("p",[t._v("Our portfordward checks indicate that you have not setup portforwarding.")]),e("p",[t._v(" In order for others to connect to this Pātaka over the Internet you'll need to enable "),e("a",{attrs:{href:"https://en.wikipedia.org/wiki/Port_forwarding",target:"_blank"}},[t._v("Port-Forwarding")]),t._v(" on your router. ")]),e("p",[t._v("Depending on your router, our portfordwarding checks maybe by inaccurate. If you believe you have correctly setup port forwarding then we recommend that you test generating a code using your internet connection")]),e("p",[t._v("Alternatively you can also connect locally without the internet via wifi. If you want to do this then please select use local network")])]),e(D.Z,[e(A.Z,[e("p",{staticClass:"overline"},[t._v("Select number of uses")]),e(ot.Z,{staticStyle:{"max-width":"300px"},attrs:{items:["single use","100 uses","1,000 uses","100,000 uses"],outlined:"",placeholder:"single use","persistent-placeholder":"",autofocus:""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),e(A.Z,[e("p",{staticClass:"overline"},[t._v("Select connection")]),e(ot.Z,{staticStyle:{"max-width":"300px"},attrs:{items:t.portForwarding?["Connect globally over internet"]:["Connect globally over internet","Connect locally over wifi"],outlined:"",placeholder:t.portForwarding?"connect globally over internet":"connect locally over wifi","persistent-placeholder":"",autofocus:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1)],1)],1)]},proxy:!0},{key:"actions",fn:function(){return[e("div",[e(S.Z,{staticClass:"primary--text my-2",attrs:{text:"",large:""},on:{click:function(e){return t.submit()}}},[t._v("Generate code")])],1)]},proxy:!0}])})},nt=[],lt=a(3058),ct=a(5223),ut=a(2570),pt=a(4192),dt=a(5234),ht=function(){var t=this,e=t._self._c;return e(ut.Z,{attrs:{"max-width":t.width,light:!t.dark,fullscreen:t.mobile,transition:t.mobile?"dialog-bottom-transition":"scale-transition"},on:{input:t.close},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[e(lt.Z,[e(p.Z,{attrs:{color:"#292929",dark:!t.dark,src:t.banner,flat:"",dense:"",height:"60px","max-height":"60px"},scopedSlots:t._u([{key:"img",fn:function({props:a}){return[e(O.Z,t._b({staticStyle:{opacity:"40%",left:"100px"}},"v-img",a,!1))]}}])},[t.mobile?e(S.Z,{attrs:{icon:""},on:{click:t.closeDialog}},[e(E.Z,[t._v("mdi-arrow-left")])],1):t._e(),t.mobile?e(dt.Z,{staticStyle:{"min-width":"10%"}}):t._e(),e("div",{staticClass:"dialog-title text-uppercase",style:t.mobile?"text-align:end":""},[e("span",{staticStyle:{color:"#BA041B"}},[t._v(t._s(t.splitTitle.maori))]),e("span",[t._v(t._s(t.splitTitle.english))])]),t.mobile?t._e():e(dt.Z),t.mobile?t._e():e(S.Z,{attrs:{icon:""},on:{click:t.closeDialog}},[e(E.Z,[t._v("mdi-close")])],1)],1),e(ct.ZB,{staticClass:"pa-3 pb-0",style:t.mobile?"overflow-x: hidden;":"max-height: 650px; overflow-x: hidden;"},[t._t("content")],2),e(pt.Z),t.readonly?t._e():e(ct.h7,{staticClass:"pa-0"},[e(L.Z,{staticClass:"py-0"},[e(D.Z,{staticClass:"ma-0",attrs:{align:"end"}},[t.$slots["before-actions"]?e(A.Z,{staticClass:"py-0",attrs:{cols:"12",md:"auto",align:t.mobile?"center":"start"}},[t._t("before-actions")],2):t._e(),t.mobile?t._e():e(dt.Z),t._t("actions",(function(){return[e(A.Z,{attrs:{cols:"6",md:"auto",align:"center"}},[e(S.Z,{staticClass:"secondary--text",attrs:{text:"",large:!t.mobile},on:{click:t.close}},[t._v(" Cancel ")])],1),e(A.Z,{attrs:{cols:"6",md:"auto",align:"center"}},[e(S.Z,{attrs:{large:!t.mobile,text:"",color:"blue"},on:{click:t.submit}},[t._v(" Save ")])],1)]}))],2)],1)],1)],1)],1)},mt=[],gt=a.p+"img/bg-tohu.8ab98236.png",ft={name:"Dialog",props:{show:{type:Boolean,required:!1},isEditing:{type:Boolean,required:!1},width:{type:String,required:!1,default:"1000px"},height:{type:String,default:"calc(100vh)"},background:{type:String,default:""},goBack:Function,enableMenu:Boolean,enableBar:{type:Boolean,default:!0},title:String,dark:Boolean,readonly:Boolean},data(){return{showDialog:this.show,listener:null,banner:gt,isSubmitting:!1}},computed:{mobile(){return this.$vuetify.breakpoint.xs||this.$vuetify.breakpoint.sm},style(){return{position:"fixed",backgroundColor:"#292929",maxWidth:this.width}},splitTitle(){let t={};const e=this.title,a="----";if(-1!==e.indexOf(a)){const a="-",r=2,o=e.split(a).slice(0,r+1).join(a),i=e.split(a).slice(r).join(a);return t={maori:o,english:i},t}return t={maori:"",english:e},t}},methods:{submit(){this.isSubmitting||(this.isSubmitting=!0,this.$emit("submit"))},closeDialog(){this.isSubmitting=!1,this.showDialog=!1,this.close()},close(){this.isSubmitting=!1,this.$emit("close")}},mounted(){this.listener=document.addEventListener("keydown",(t=>{27===t.keyCode&&this.close()})),document.body.style.top=`-${window.scrollY}px`,document.body.style.minWidth="100%",document.body.style.position="fixed"},destroyed(){document.removeEventListener("keydown",this.listener);const t=document.body.style.top;document.body.style.position="",document.body.style.top="",window.scrollTo(0,-1*parseInt(t||"0"))}},yt=ft,vt=(0,f.Z)(yt,ht,mt,!1,null,null,null),bt=vt.exports,wt={name:"GenerateInviteDialog",components:{Dialog:bt},props:{show:{type:Boolean,required:!0},title:{type:String},publicIpv4:{type:String,default:"xxx.xxx.xx.xx"},portForwarding:{type:Boolean,default:!0},checkPortForwarding:{type:Function},checkingPort:{type:Boolean,default:!1},errorMsg:{type:String},cloudHost:{type:Boolean}},data(){return{type:"",value:"",externalIp:null}},computed:{ip:{get:function(){return this.externalIp||this.publicIpv4},set:function(t){this.externalIp=t}},uses(){switch(this.value){case"single use":return 1;case"100 uses":return 100;case"1,000 uses":return 1e3;case"100,000 uses":return 1e5;default:return 1}}},methods:{submit(){let t;t=this.cloudHost?window.location.hostname:"Connect locally over wifi"===this.type?null:this.externalIp||this.publicIpv4,this.$emit("generate",{ip:t,uses:this.uses}),this.close()},close(){this.$emit("close")}}},kt=wt,_t=(0,f.Z)(kt,st,nt,!1,null,"e567785e",null),Zt=_t.exports,xt=a(9868),Ct=a(3625),Pt=function(){var t=this,e=t._self._c;return e(lt.Z,{staticClass:"mt-4",attrs:{"max-width":"400"}},[e(xt.Z,{staticClass:"v-sheet--offset mx-auto",attrs:{color:"primary",tile:""}},[e(ct.ZB,[e(D.Z,{staticClass:"mt-0 ml-0",attrs:{align:"end"}},[e("h2",[t._v(t._s(t.title))]),t._v(" "),e("span",{staticClass:"pl-4 caption"},[t._v("usage in last hour")])])],1),e(Ct.Z,{attrs:{labels:t.labels,value:t.values,gradient:["red","#0484c4","#53cb62"],"line-width":"1",padding:"16"}})],1)],1)},It=[],St={name:"Meter",props:{title:String,labels:Array,values:Array}},At=St,Lt=(0,f.Z)(At,Pt,It,!1,null,"60b500b3",null),Et=Lt.exports;const Bt=1e3;var Dt={name:"Dashboard",data:()=>({dialog:!1,ipSet:!1,copyText:"Copy",generatedInvite:null,generateError:!1,errorMsg:null,checkingPort:null,invitedPeople:[],tribes:[],profile:{feedId:"",preferredName:"",avatarImage:null},portForwarding:null,network:{internetLatency:null,ipv4:null,ipv6:null,publicIpv4:null},diskUsage:[],cpuLoad:[0,0],memoryLoad:[0,0]}),computed:{latency(){return this.network.internetLatency&&-1!==this.network.internetLatency?`${this.network.internetLatency} ms`:"Unknown"},cloudHost(){return"file://"!==window.location.origin&&"localhost"!==window.location.hostname},connectedPeople(){return this.invitedPeople.filter((t=>"pataka"!==t.type))}},apollo:{profile:{query:o.ZP`query {
        whoami {
          public {
          feedId
          profile {
            id
            preferredName
            avatarImage {
              uri
            }
          }
          }
        }
      }`,update(t){return t.whoami.public.profile&&t.whoami.public.profile.preferredName||this.$router.push({name:"login"}),{...t.whoami.public.profile,feedId:t.whoami.public.feedId}}},network:{query:o.ZP`query {
        network {
          ipv4
          internetLatency
          publicIpv4
          portForwarding
        }
      }`,pollInterval:10*Bt},portForwarding:{query:o.ZP`query {
        network {
          portForwarding
        }
      }`,update(t){return t.network.portForwarding}},cpuLoad:{query:o.ZP`query {
        cpuLoad
      }`,pollInterval:10*Bt,update(t){return this.cpuLoad.length>=360||0===this.cpuLoad[this.cpuLoad.length-1]?this.cpuLoad.pop():0===this.cpuLoad[0]&&this.cpuLoad.shift(),[...this.cpuLoad,t.cpuLoad]}},memoryLoad:{query:o.ZP`query {
        memoryLoad
      }`,pollInterval:10*Bt,update(t){return this.memoryLoad.length>=360?this.memoryLoad.pop():0===this.memoryLoad[0]&&this.memoryLoad.shift(),[...this.memoryLoad,t.memoryLoad]}},diskUsage:{query:o.ZP`query {
        diskUsage {
          use
          fs
        }
      }`,pollInterval:10*Bt},invitedPeople:{query:o.ZP`query {
        invitedPeople {
          type
          id
          preferredName
          avatarImage {
            uri
          }
          ...on Person {
            gender
          }
        }
      }
      `,pollInterval:5*Bt},tribes:{query:o.ZP`query {
        tribes {
          public {
            preferredName
            avatarImage {
              uri
            }
          }
        }
      }`,update(t){return t.tribes.filter((t=>t.public&&t.public[0])).map((t=>t.public[0]))},pollInterval:10*Bt}},methods:{logout(){this.$router.push("/")},async toggleDialog(){this.dialog=!this.dialog},async generateInviteCode({ip:t,uses:e}){const a=t?{external:t,uses:e}:{uses:e};try{const t=await this.$apollo.mutate({mutation:o.ZP`
              mutation ($input: createInviteInput) {
                createInvite(input: $input)
              }
              `,variables:{input:{...a}}});this.generateError=!1,this.dialog=!1,this.generatedInvite=t.data.createInvite,this.copyText="Copy"}catch(r){throw console.error(r),this.generateError="something went wrong while trying to generate an invite code",r}},async tryInvite(){this.portForwarding&&await this.generateInviteCode(this.network.publicIpv4)},async checkPortForwarding(){this.checkingPort=!0,this.errorMsg=null;const t=await this.$apollo.query({query:o.ZP`query {
            network {
              portForwarding
            }
          }`}),e=t.data.network.portForwarding;this.portForwarding=e,e?(await this.tryInvite(),this.errorMsg=null):this.errorMsg="Port not open",this.checkingPort=!1},async copyCode(){navigator.clipboard.writeText(this.generatedInvite).then((()=>{this.copyText="Copied"})).catch((t=>{console.error("Could not copy text: ",t)}))}},components:{Avatar:J,AvatarGroup:rt,Meter:Et,GenerateInviteDialog:Zt}},Tt=Dt,$t=(0,f.Z)(Tt,T,$,!1,null,null,null),Ft=$t.exports,Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[t.isLoading?e("div",{staticClass:"splash"},[e("img",{attrs:{src:a(9432)}}),e("h1",[t._v("Āhau Pātaka")])]):t._e(),t.isLoading||t.isSetup?!t.isLoading&&t.isSetup&&t.cloudHost?e("div",{staticClass:"welcome-text",staticStyle:{"justify-items":"center",display:"grid"}},[e(D.Z,{staticClass:"pb-12"},[e("p",{staticClass:"mb-0 headliner2",staticStyle:{color:"darkgrey"}},[t._v("enter password")])]),e(D.Z,{staticClass:"mt-10"},[e(A.Z,{attrs:{cols:"12"}},[e(it.Z,{staticStyle:{"background-color":"#303030",width:"300px"},attrs:{label:"Password",outlined:"",width:"150px",type:"password","error-messages":t.passwordRules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.checkPassword.apply(null,arguments)}},model:{value:t.passwordInput,callback:function(e){t.passwordInput=e},expression:"passwordInput"}})],1)],1),e(D.Z,[e(S.Z,{staticStyle:{"border-color":"#b12526","background-color":"#303030"},attrs:{text:"",color:"#b12526",outlined:""},on:{click:function(e){return e.preventDefault(),t.createPassword.apply(null,arguments)}}},[e("p",{staticClass:"login-text mb-0"},[t._v("submit")])])],1)],1):t._e():e("div",{staticClass:"welcome-text",staticStyle:{"justify-items":"center",display:"grid"}},[e(D.Z,[e("p",{staticClass:"mb-0 headliner"},[t._v("Nau mai")])]),e(D.Z,[e("p",{staticClass:"mb-0 headliner"},[t._v("Whakatau mai")])]),e(D.Z,{staticClass:"pb-12"},[e("p",{staticClass:"mb-0 headliner2",staticStyle:{color:"darkgrey"}},[t._v("welcome")])]),e(D.Z,{staticClass:"mt-10"},[e(S.Z,{staticStyle:{"border-color":"#b12526","background-color":"#303030"},attrs:{text:"","x-large":"",color:"#b12526",outlined:""},on:{click:function(e){return e.preventDefault(),t.toggleNew.apply(null,arguments)}}},[e("p",{staticClass:"login-text mb-0"},[t._v("create pataka")])])],1)],1),t.dialog?e("NewNodeDialog",{attrs:{show:t.dialog,title:"Āhau Pātaka"},on:{close:t.toggleNew,create:function(e){return t.save(e)}}}):t._e()],1)},Ot=[],jt=function(){var t=this,e=t._self._c;return e("Dialog",{attrs:{show:t.show,title:t.title,width:"720px",goBack:t.close,enableMenu:""},on:{close:t.close},scopedSlots:t._u([{key:"content",fn:function(){return[e(A.Z,{staticClass:"py-0"},[e("ProfileForm",{attrs:{profile:t.formData,mobile:t.mobile},on:{"update:profile":function(e){t.formData=e}}})],1)]},proxy:!0},{key:"actions",fn:function(){return[e(S.Z,{staticClass:"secondary--text",attrs:{text:"",large:"",fab:""},on:{click:t.close}},[e("span",{attrs:{color:"secondary"}},[t._v("cancel")])]),e(S.Z,{staticClass:"blue--text ml-5",attrs:{text:"",large:"",fab:""},on:{click:t.submit}},[e("span",[t._v("save")])])]},proxy:!0}])})},qt=[],Mt=a(6904),zt=a(5617),Ut=function(){var t=this,e=t._self._c;return e(Mt.Z,{ref:"form",staticClass:"px-4 pt-4",attrs:{light:""}},[e(D.Z,[e(A.Z,{staticClass:"pt-6",attrs:{order:t.mobile?"":"2"}},[e(D.Z,{staticClass:"justify-center pt-3"},[e("Avatar",{staticClass:"big-avatar",attrs:{size:"200px",type:"pataka",image:t.formData.avatarImage,alt:t.formData.preferredName,isEditing:t.isEditing,isView:!1},on:{updateAvatar:function(e){t.formData.avatarImage=e}}})],1),t.isEditing?e(D.Z,{staticClass:"justify-center"},[e(S.Z,{staticClass:"blue--text",attrs:{color:"white",text:"",medium:""},on:{click:function(e){return t.$emit("cancel")}}},[e(E.Z,{staticClass:"blue--text",attrs:{small:"",left:""}},[t._v("mdi-close")]),t._v("Cancel ")],1)],1):t._e(),e(D.Z,[t.isEditing?t._e():e(A.Z,{staticClass:"pa-0",attrs:{cols:"12",justify:"center",align:"center"}},[e("ImagePicker",{attrs:{avatarLoaded:t.formData.avatarImage},on:{updateAvatar:function(e){t.formData.avatarImage=e}}})],1)],1)],1),e(A.Z,{staticClass:"pt-2",attrs:{cols:"12",sm:t.mobile?"12":"6"}},[e(D.Z,[e(A.Z,{staticClass:"pa-1",attrs:{cols:"12"}},[e(it.Z,{attrs:{label:"Pātaka name",outlined:"",rules:t.nameRules,required:""},model:{value:t.formData.preferredName,callback:function(e){t.$set(t.formData,"preferredName",e)},expression:"formData.preferredName"}})],1)],1),e(D.Z,[e(A.Z,{staticClass:"pa-1",attrs:{cols:"12"}},[e(zt.Z,{attrs:{label:"Description","no-resize":"",rows:"5","auto-grow":"",outlined:""},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1)],1)],1)],1)],1)},Ht=[],Rt=function(){var t=this,e=t._self._c;return e("div",[e("clipper-upload",{attrs:{accept:"image/*"},on:{input:t.toggleAvatar}},[e(D.Z,{staticClass:"upload-pic-row"},[e(E.Z,{staticClass:"grey--text pr-2 pt-1"},[t._v("mdi-camera")]),e("p",{staticClass:"toggle"},[t._v(" "+t._s(t.label||"Upload Photo")+" ")])],1)],1),t.avatar.showEditor?e("AvatarEditDialog",{attrs:{show:t.avatar.showEditor,avatarImage:t.avatar.new,isView:t.isView,type:t.type},on:{submit:function(e){return t.updateAvatar(e)},close:function(e){return t.toggleAvatar(null)}}}):t._e()],1)},Vt=[],Gt=function(){var t=this,e=t._self._c;return e("Dialog",{attrs:{title:"Crop Photo",show:t.show,width:"750px",goBack:t.close,enableMenu:"",dark:""},on:{submit:t.submit,close:t.close},scopedSlots:t._u([{key:"content",fn:function(){return[e(D.Z,{attrs:{justify:"center"}},[e(A.Z,{staticStyle:{"max-width":"300px"}},[e("clipper-fixed",{ref:"avatar",attrs:{grid:!1,src:t.avatarImage,area:100,round:!t.tile,"bg-color":"rgba(0, 0, 0, 0)",shadow:"rgba(0,0,0,0.5)",rotate:t.rotation}})],1)],1),e("div",{staticClass:"px-8 py-4"},[e("h6",{staticClass:"caption pt-8 white--text"},[e(E.Z,{attrs:{dark:""}},[t._v("mdi-gesture-tap")]),t._v(" Adjust the image by zooming, scaling and moving it around before saving. ")],1),e("h5",{staticClass:"pt-8 white--text"},[t._v("rotate")]),e("clipper-range",{staticStyle:{"max-width":"300px"},attrs:{min:0,max:360},model:{value:t.rotation,callback:function(e){t.rotation=e},expression:"rotation"}})],1)]},proxy:!0}])})},Wt=[];function Xt(t){return new window.File([t],"avatar",{type:t.type})}const Kt=o.ZP`
  mutation uploadFile($file: Upload!, $size: Int!, $encrypt: Boolean) {
    uploadFile(file: $file, size: $size, encrypt: $encrypt) {
      type
      blobId
      mimeType
      uri
      size

      ...on BlobScuttlebutt {
        unbox
      }

      ...on BlobHyper {
        driveAddress
        readKey
      }
    }
  }
`;function Jt(t){return{mutation:Kt,variables:{file:t.file,size:t.file.size,encrypt:t.encrypt}}}const Yt="$2a$10$8tvJDew.Y.cYfb01hq8nPeq9MpnhneiINRdzS3AsA7AtXZZ0Vt5EG",Qt=1048576,te=5*Qt;var ee={name:"AvatarEditDialog",components:{Dialog:bt},props:{show:{type:Boolean,default:!1},avatarImage:String,tile:Boolean},data(){return{rotation:0}},methods:{close(){this.$emit("close")},async submit(){try{const t=this.$refs.avatar.clip({maxWPixel:"header"===this.type?1920:800});t.toBlob((async t=>{const e=Xt(t);if(e.size>=5242880)throw console.error("this avatar image is bigger than 5MB, we cannot allow this through, otherwise it will end up a hyperblob, which AvatarImage does not currently support"),new Error("avatar image must me < 5MB");const a=await this.uploadFile({file:e,encrypt:!0});null===a.mimeType&&(a.mimeType=e.type),"Hello World"===a.mimeType&&(a.mimeType=e.type),a.blobId&&(a.blob=a.blobId),delete a.blobId;const r={};Object.entries(a).forEach((([t,e])=>{"__typename"!==t&&"type"!==t&&(r[t]=e)})),this.$emit("submit",r)}))}catch(t){console.error("Error editing avatar",t)}},async uploadFile(t){try{if(t.file&&t.file.size>te)throw new Error("Please check the file size is less than 5MB");const e=await this.$apollo.mutate(Jt(t));if(e.errors)throw e.errors;return e.data.uploadFile}catch(e){return console.error("Something went wrong while trying to upload a file",e),null}}}},ae=ee,re=(0,f.Z)(ae,Gt,Wt,!1,null,null,null),oe=re.exports,ie={name:"ImagePicker",components:{AvatarEditDialog:oe},props:{label:{type:String},isView:{type:Boolean,default:!1},type:String},data(){return{avatar:{new:null,showEditor:!1}}},methods:{toggleAvatar(t){this.avatar.new=this.avatar.new?null:t,this.avatar.showEditor=!this.avatar.showEditor},updateAvatar(t){this.$emit("updateAvatar",t),this.toggleAvatar(null)}}},se=ie,ne=(0,f.Z)(se,Rt,Vt,!1,null,"416cf575",null),le=ne.exports,ce={name:"ProfileForm",components:{Avatar:J,ImagePicker:le},props:{profile:{type:Object,required:!0},mobile:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1}},data(){return{formData:this.profile,form:{valid:!0,showDescription:!1},nameRules:[t=>!!t||"Pataka name required"]}}},ue=ce,pe=(0,f.Z)(ue,Ut,Ht,!1,null,"2f523851",null),de=pe.exports,he=a(9245),me=a.n(he);function ge(){const t={id:"",preferredName:"",avatarImage:{},description:""};return t}var fe={name:"NewNodeDialog",components:{Dialog:bt,ProfileForm:de},props:{show:{type:Boolean,required:!0},title:{type:String,default:"Create a new Pātaka"}},data(){return{formData:ge()}},computed:{mobile(){return this.$vuetify.breakpoint.xs},submission(){const t={};return Object.entries(this.formData).forEach((([e,a])=>{me()(this.formData[e])||(t[e]=a)})),t}},methods:{submit(){this.submission&&!this.submission.preferredName||(this.$emit("create",this.submission),this.close())},close(){this.resetFormData(),this.$emit("close")},resetFormData(){this.formData=ge()}}},ye=fe,ve=(0,f.Z)(ye,jt,qt,!1,null,"6364d7fa",null),be=ve.exports,we=a(5030),ke=a.n(we),_e=a(2418),Ze=a.n(_e);const xe="\n---------------------------------\nE te tangata\nWhāia te māutauranga kai mārama\nKia whai take ngā mahi katoa\nTū māia, tū kaha\nAroha atu, aroha mai\nTātou i a tātou katoa\n\nFor this person\nSeek knowledge for understanding\nHave purpose in all that you do\nStand tall, be strong\nLets us all show respect\nFor each other\n---------------------------------\n";var Ce={data(){return{isLoading:!0,isSetup:!1,profile:{id:null,preferredName:null,avatarImage:null},dialog:!1,passwordInput:"",passwordError:!1,passwordRules:[]}},computed:{cloudHost(){return"file://"!==window.location.origin&&"localhost"!==window.location.hostname}},mounted(){this.getCurrentIdentity()},methods:{async createPassword(){await Ze().hash(this.passwordInput,10,(function(t,e){t?console.log("error encrypting password: ",t):console.log("hash: ",e)}))},checkPassword(){Ze().compare(this.passwordInput,Yt).then((t=>{t?(this.karakiaTūwhera(),this.$router.push({name:"dashboard"})):this.passwordRules.push("Password incorrect. Try again")}))},async getCurrentIdentity(){const t=await this.$apollo.query({query:o.ZP`
          {
            whoami {
              public {
                profile {
                  id
                  preferredName
                  avatarImage {
                    uri
                  }
                }
              }
            }
          }
        `,fetchPolicy:"no-cache"});if(t.errors)throw t.errors;t.data.whoami.public.profile&&(this.profile=t.data.whoami.public.profile),this.proceed()},"karakiaTūwhera"(){console.log(xe)},proceed(){if(this.$apollo.loading||!this.profile.id)return console.log("waiting for apollo"),void setTimeout(this.proceed,300);this.isSetup=Boolean(this.profile.preferredName),this.isSetup&&!this.cloudHost&&(this.karakiaTūwhera(),this.$router.push({name:"dashboard"})),this.isLoading=!1},toggleNew(){this.dialog=!this.dialog},async save(t){const e=ke()(t,"preferredName","description","avatarImage");e.avatarImage&&delete e.avatarImage.uri;const a=await this.$apollo.mutate({mutation:o.ZP`
          mutation($input: PatakaProfileInput!) {
            savePataka(input: $input)
          }
        `,variables:{input:{id:this.profile.id,...e}}});a.errors?console.error("failed to update profile",a):this.getCurrentIdentity()}},components:{NewNodeDialog:be}},Pe=Ce,Ie=(0,f.Z)(Pe,Nt,Ot,!1,null,"094fac74",null),Se=Ie.exports;r.ZP.use(I.ZP);var Ae=new I.ZP({mode:"history",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:Se},{path:"/logout",redirect:"/login"},{path:"/dashboard",name:"dashboard",component:Ft},{path:"*",redirect:"/"}]}),Le=a(6486),Ee=a(8891),Be=a.n(Ee);const{VUE_APP_MIXPANEL_TOKEN:De,VUE_APP_MIXPANEL_API_HOST:Te="https://api-eu.mixpanel.com"}={NODE_ENV:"production",VUE_APP_MIXPANEL_TOKEN:"34c9aa7a76fedf7e4bd6f6e1d118a251",VUE_APP_MIXPANEL_API_HOST:"https://api-eu.mixpanel.com",VUE_APP_PLATFORM:"web",BASE_URL:""},$e=1e3,Fe=60*$e,Ne=60*Fe,Oe=1*Ne,je={track(...t){}};je.throttledTrack=(0,Le.throttle)(je.track,Oe);const qe={};function Me(){return window.ahoy?(Be().init(De,{api_host:Te}),window.ahoy.getConfig().then((t=>{const e=t.mixpanelId;Be().identify(e),Be().people.set({application:"ahau",isPataka:!0,isMobile:!1,userId:e}),Be().throttledTrack=(t,...e)=>(qe[t]||(qe[t]=(0,Le.throttle)(Be().track,Oe,{trailing:!1}).bind(Be(),t)),qe[t](...e))})),Be()):(console.log("(analytics) window.ahoy not found - this is only accessible in electron"),je)}var ze=Me();const Ue=a(9876).version,He={},Re={},Ve={},Ge={patakaPing({state:t,commit:e}){ze.throttledTrack("pataka-ping",{version:Ue})}};var We={namespaced:!0,state:He,getters:Re,mutations:Ve,actions:Ge};r.ZP.use(u.ZP);const Xe={state:{},getters:{},mutations:{},actions:{}};var Ke=new u.ZP.Store({...Xe,modules:{analytics:We}}),Je=a(2489),Ye=a(692),Qe=JSON.parse('{"__schema":{"types":[{"name":"Blob","kind":"INTERFACE","possibleTypes":[{"name":"BlobScuttlebutt","description":"Blobs of the ssb-blobs variety"},{"name":"BlobHyper","description":"Blobs of the ssb-hyper-blobs variety"}]},{"name":"_Entity","kind":"UNION","possibleTypes":[{"name":"CurrentIdentity","description":"Secure Scuttlebutt current identity"},{"name":"PublicIdentity","description":null},{"name":"PersonalIdentity","description":null},{"name":"Peer","description":"Secure Scuttlebutt replication peer"}]},{"name":"Profile","kind":"INTERFACE","possibleTypes":[{"name":"Person","description":"Person fields used by ssb-profile plugin"},{"name":"Pataka","description":null},{"name":"Community","description":"Community profile (fields from ssb-profile plugin)"}]}]}}');const ta=a(5926)(),ea={NODE_ENV:"production",VUE_APP_MIXPANEL_TOKEN:"34c9aa7a76fedf7e4bd6f6e1d118a251",VUE_APP_MIXPANEL_API_HOST:"https://api-eu.mixpanel.com",VUE_APP_PLATFORM:"web",BASE_URL:""}.VUE_APP_GRAPHQL_HTTP||`http://localhost:${ta.pataka.graphql.port}/graphql`;function aa(t={}){const e=new Ye.Z(ea,{possibleTypes:Qe,...t}),a=new Je.ZP({defaultClient:e,defaultOptions:{$query:{}},errorHandler(t){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",t.message)}});return a}r.ZP.use(Je.ZP);aa();var ra=a(2250);const oa="#bfbfbf",ia="#427979";var sa={theme:{dark:!0,themes:{dark:{primary:"#383838",secondary:"#A80000",accent:"#A70000",error:"#ff0000",alive:ia,deceased:oa}},options:{customProperties:!0}},icons:{iconfont:"mdi"}};r.ZP.use(ra.Z);var na=new ra.Z(sa);async function la(){r.ZP.use(i.ZP),r.ZP.config.productionTip=!1;const t=aa();async function e(a){try{await t.defaultClient.query({query:o.ZP`{
          whoami {
            public {
              feedId
            }
          }
        }`})}catch(r){return console.log("Waiting for Graphql"),setTimeout((()=>e(a)),500)}a()}e((()=>{new r.ZP({router:Ae,store:Ke,apolloProvider:t,vuetify:na,render:t=>t(P)}).$mount("#app")}))}la()},9432:function(t,e,a){"use strict";t.exports=a.p+"img/logo_red.d388862f.svg"},5995:function(){},9876:function(t){"use strict";t.exports=JSON.parse('{"name":"pataka","version":"4.0.1","description":"A pub application for the Ahau ecosystem. Built using scuttlebutt","homepage":"https://gitlab.com/ahau/pataka","scripts":{"postinstall":"electron-builder install-app-deps && cd ui && npm i","start":"electron index.js -- --title Pātaka","dev":"cross-env NODE_ENV=development electron index.js -- --title Pātaka","serve":"cd ui && npm run dev","build:ui":"cd ui && npm run build","build:icons":"node build/build-icons.js","pack":"electron-builder --config build/electron-builder.config.js --dir","dist":"electron-builder --config build/electron-builder.config.js","publish":"electron-builder --config build/electron-builder.config.js --publish always","move-release":"rimraf releases && mvy dist/installers releases","release":"npm run build:ui && npm run publish && npm run move-release","lint":"cd ui && npm run lint"},"dependencies":{"ahau-env":"^3.0.0","boxen":"^5.1.2","chalk":"^4.1.2","electron-updater":"^4.6.5","env-paths":"^2.2.1","lodash.merge":"^4.6.2","secret-stack":"^6.4.1","ssb-ahoy":"^5.0.1","ssb-backlinks":"^2.1.1","ssb-blobs":"^2.0.0","ssb-config":"^3.4.6","ssb-conn":"^1.0.0","ssb-db":"^20.4.1","ssb-friends":"^4.4.8","ssb-hyper-blobs":"^3.0.0","ssb-invite":"^3.0.1","ssb-lan":"^1.2.3","ssb-master":"^1.0.3","ssb-no-auth":"^1.0.0","ssb-pataka":"^5.0.3","ssb-profile":"^5.15.0","ssb-query":"^2.4.5","ssb-recps-guard":"^2.1.0","ssb-replicate":"^1.3.3","ssb-serve-blobs":"^3.1.1","ssb-settings":"^1.1.4","ssb-tribes":"^3.1.2","ssb-unix-socket":"^1.0.0"},"devDependencies":{"cross-env":"^7.0.2","electron-notarize":"^1.2.2","esm":"^3.2.25","mvy":"^0.2.1","rimraf":"^2.7.1","typescript":"^3.9.6"},"author":"Āhau Ltd.","repository":{"type":"git","url":"git+https://gitlab.com/ahau/pataka.git"},"license":"AGPL-3.0"}')}},e={};function a(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=t,function(){var t=[];a.O=function(e,r,o,i){if(!r){var s=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],i=t[u][2];for(var n=!0,l=0;l<r.length;l++)(!1&i||s>=i)&&Object.keys(a.O).every((function(t){return a.O[t](r[l])}))?r.splice(l--,1):(n=!1,i<s&&(s=i));if(n){t.splice(u--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[r,o,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p=""}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,s=r[0],n=r[1],l=r[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(o in n)a.o(n,o)&&(a.m[o]=n[o]);if(l)var u=l(a)}for(e&&e(r);c<s.length;c++)i=s[c],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(u)},r=self["webpackChunkpataka_ui"]=self["webpackChunkpataka_ui"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(1160)}));r=a.O(r)})();
//# sourceMappingURL=app.554c1c00.js.map